import os
import json
from unittest.mock import Mock, patch
from getmail import getMessageValue
from datetime import datetime

mail = getMessageValue(messageID="AQMkADAwATM3ZmYAZS1kNGY3LWZhNTMtMDACLTAwCgBGAAADY9XFoJ43pEe2TYRuW9aNfAcAafGhIvVpyk_198HMOQEhIwAAAgEMAAAAafGhIvVpyk_198HMOQEhIwAFGsOrOgAAAA==",token='EwB4A8l6BAAUAOyDv0l6PcCVu89kmzvqZmkWABkAAVVy7XXZ99T3wmnYZG6B57Bbnu6y3C/dKkOHQmF+bphR0BsClBwxAeGIprUfPzxW8Zxfm/L2wz6Wv0VhMiWkwLPghsXr5L1sOQt/ukBujWUANc8SOY80k9+eKvA3yjVsRubPKkQDdTx65UMsJIQtIj4hkLACDV2vtrsAQFKYjNyWtWp8LnMH4GAT25pBLTYd3YfxHnngXIsuedXNRHDz+7/8PODujFuZTfh3hm0I/ZDEAjbJJGHeuolw8MovVYrBfjI7GkgSP7174ZiRYpEpvCtSlJ7o4nnsJkAScSv0iMXgJSbG72RAYbOlALiSzIT1w9s5R8XOZNqWyWCoye3MpwoDZgAACLwzAnsRy04eSAIPaWJ+AgPNpzX5GOEkerLRXZ3LBYsSgHM+TCelOGmrdRSCx564Uf0Y18xf96S6Elt+pi73w71Nqgl5mSF0SGQpap2hVpvREwFg+d6SSAaurNcAZiG/kmATeRZ7YIU7B52oE5YVRcIdyL+u3mQqe9M89Yi4utlFKepW7R3F055yDtGUZXNSzYpz5vaJik0uuGPNWOWQisEbcLp+/8hXoEGTjw7dUAGxbUkl8YYPBiQ23pTSQbA1VvAzBioKM2dbgujfkT/t2FBwOzxBDG+73q7jZ7wse5X2+WaA+6PH/KLBvOpRkE0K48mAXbYPQBDcOAwOzONdNI9CQVDfHdvEZtfm5VW/tg9C6GtoSo61t3g3cdUlBD1aex/ct9dzOVKFcqreAp5nfLcG/3Pv9D1UPKvx9aAUnau4uktR96catbdcExQQ/6vAMs1niy97JUbqpODJUpawwnrfjisIo8tGT0TSrxJz6+ZmWMaT4CzsegUD7An2XEIwTrGkKCs/Gv8MDeSN96e3pBhmcxERhOHWOGbWMqZjgIVYtEH8mZWcTE/wjs1lGRX73JPv2vW9cTznYY1zt7wKc5rFWd+C3nDfhPS8mXlHxEwAPjwTojOW5HdLqM1dHOPHQD3pA9ZBV8QaHjoJdpjnAvIEbGCRrKRnExrL4YDTGYQvWUWKq5N8owxoB+p44HpjBLtIkQnXjptI9qWfzfrF3ZDsm1J8k4ZDZ39+rUZGwbjEv7/cuiEOHMPCRLCd8tAZsnj8eAv6QS0eRIMmAzjh+78B4ocC')
#print(mail)

received_datetime = datetime.strptime(mail['receivedDateTime'], "%Y-%m-%dT%H:%M:%SZ").strftime("%Y-%m-%d %H:%M:%S")

#把信件的值取出
MessageID, Subject, Received, Sender= \
    mail['id'],mail['subject'], received_datetime, mail['from']['emailAddress']['address']

# 假如不在那就加入資料庫並且繼續掃描
print(MessageID, Subject, Received,Sender)